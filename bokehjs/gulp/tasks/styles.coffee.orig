# styles - build or minify CSS

gulp = require "gulp"
less = require "gulp-less"
uglifycss = require "gulp-uglifycss"
rename = require "gulp-rename"
runSequence = require "run-sequence"
sourcemaps = require "gulp-sourcemaps"

paths = require "../paths"
utils = require "../utils"

gulp.task "styles:build", ->
  gulp.src paths.less.sources
    .pipe sourcemaps.init
      loadMaps: true
    .pipe less()
<<<<<<< HEAD
    .pipe sourcemaps.write './'
    .pipe gulp.dest paths.buildDir.css
=======
    .pipe gulp.dest(paths.buildDir.css)
>>>>>>> 59b0904d05aa8a9e1df8cbc2e7b7a6649f122ae3

gulp.task "styles:minify", ->
  gulp.src paths.css.sources
<<<<<<< HEAD
    .pipe rename "bokeh.min.css"
    .pipe sourcemaps.init
      loadMaps: true
    .pipe uglifycss()
    .pipe sourcemaps.write './'
    .pipe gulp.dest paths.buildDir.css
=======
    .pipe rename((path) -> path.basename += ".min")
    .pipe gulp.dest(paths.buildDir.css)
    .pipe sourcemaps.init({loadMaps: true})
    .pipe minifyCSS opts
    .pipe sourcemaps.write("./")
    .pipe gulp.dest(paths.buildDir.css)
>>>>>>> 59b0904d05aa8a9e1df8cbc2e7b7a6649f122ae3

gulp.task "styles", (cb) ->
  runSequence("styles:build", "styles:minify", cb)
